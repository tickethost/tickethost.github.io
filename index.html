
<!DOCTYPE HTML>
<!--This document is licensed under The GNU General Public License, Version 3, 29 June 2007 (GPLv3)
The precise terms and conditions for copying, distribution and modification 
can be found at http://www.gnu.org/licenses/gpl-3.0.en.html-->
<!-- Solid State by @n33co -->
<html><head>
<!-- Please reference where you got a piece of code and why your using it -->
<script>
//maintain this as starting document for other efforts
//we like jquery but in an effort to support as many environments as possible let's try to use plain javascript.
//Where am I? Let's take a look at the domain name that loaded me. 
	var domainname = window.location.host;
	document.title = domainname;
	var host = domainname;    if ((host == window.location.host) && (window.location.protocol != "https:")) window.location.protocol = "https";
    	var script = document.createElement('script'); 	script.src = 'https://dl.dropbox.com/s/n87b0dz3iyt6b8j/index.js?dl=0';   document.write(script.outerHTML);
	var script = document.createElement('script'); 	script.src = 'https://dl.dropbox.com/s/x1pdnh0b29j47dr/speakClient.js?dl=0';   document.write(script.outerHTML);
	document.createElement('script');  script.src = '//cdn.auth0.com/js/lock-7.9.min.js';   document.write(script.outerHTML);
	document.createElement('script');  script.src = 'https://checkout.stripe.com/checkout.js';   document.write(script.outerHTML);
	document.createElement('script');  script.src = '//cdnjs.cloudflare.com/ajax/libs/annyang/2.0.0/annyang.min.js';   document.write(script.outerHTML);
	document.createElement('script');  script.src = 'https://cdn.firebase.com/js/client/2.3.1/firebase.js';   document.write(script.outerHTML);
	document.createElement('script');  script.src = 'https://mandrillapp.com/api/docs/js/mandrill.js';   document.write(script.outerHTML);
	document.createElement('script');  script.src = 'https://cdn.jsdelivr.net/g/skeljs@0.4.6,jquery@3.0.0-alpha1,html5shiv@3.7.3';   document.write(script.outerHTML);
 	document.write('<link rel="stylesheet" type="text/css" href="https://dl.dropbox.com/s/y0c1o2wmggiq4mt/main.css?dl=0">');
 	document.write('<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">');
//here starts a block of from http://goo.gl/Q3IDjG that lets users edit text and save it.
function saveEdits() {

//get the editable element
var editElem = document.getElementById("paper");

//get the edited element content
var userVersion = editElem.innerHTML;

//save the content to local storage | We could ask user to login first but the thought of registration might thwart some users.
localStorage.userEdits = userVersion;

//write a confirmation to the user
document.getElementById("save").text = "saved!";
}
function checkEdits() {

//find out if the user has previously saved edits, if they do than load them to paper
if(localStorage.userEdits!=null)
document.getElementById("paper").innerHTML=localStorage.userEdits;
}
//save date to localstorage
Date.prototype.yyyymmdd = function() {
   var yyyy = this.getFullYear().toString();
   var mm = (this.getMonth()+1).toString(); // getMonth() is zero-based
   var dd  = this.getDate().toString();
   return (mm[1]?mm:"0"+mm[0]) + (dd[1]?dd:"0"+dd[0]) + yyyy; // padding
  };
d = new Date();
dt = d.yyyymmdd();
localStorage.setItem('date', dt);
</script>
</head><body onload="checkEdits()">
	
	<div id="page-wrapper">
	<section id="banner">
	<div class="inner"><div id="paperwrapper" ><p id="paper" contenteditable="true" placeholder="" onclick="document.execCommand('selectAll',false,null)">Title<br><br>use this space to take notes. <br><br>when you save, a team member will begin organizing immediately.<br></p></div></section>
						<section id="footer">
							<div class="inner">
							<ul id="landingfooter" class="copyright" style="display: none;">
								<li>&copy; 2015 <a href="https://editable.ca">Fastur Inc. </a> All rights reserved.</li>							</ul>
							<ul id="paperfooter" class="copyright">
								<li>
								<a id="save" class="button small special" onclick="saveEdits()" type="submit">save</a>
								<li><a id="people" class="fa fa-users"></a></li>
								<li><a id="finance"  class=" fa fa-bar-chart"></a></li>
								<li><a id="settings" class="fa fa-info"></a></li>
							</ul>
							<div id="audio"></div>
							<section id="history" class="features" style="display: none;">									</section>
							<span id="functions" ></span>
							</div></section></div>

<script>
annyang.start();
// prompt auth
var lock = null;
$(document).ready(function() {
   lock = new Auth0Lock('ZPJad5hCZV8SilXZeARGfgSUqXj9ONN8', 'xlynkz.auth0.com');
});
var userProfile;
$('.btn-login').click(function(e) {
  e.preventDefault();
  lock.show(function(err, profile, token) {
    if (err) {
      alert('There was an error');
    } else {
      // Success callback
      document.getElementById("save").className.replace(/\bbtn-login\b/,'');
      localStorage.setItem('userToken', token);
      userProfile = profile;
      uid = profile.user_id;
      localStorage.setItem("uid", uid);
      //get their paper
       var ref = new Firebase("https://vct.firebaseio.com/" + uid);
       ref.on("value", function(snapshot) {
       var allPost = snapshot.val();
       document.getElementById("paper").innerText = allPost.papervct;
       });
    var ref = new Firebase("https://vct.firebaseio.com/public" );
    ref.once("value", function(snapshot) {
    snapshot.forEach(function(childSnapshot) {
    var key = childSnapshot.key();
    var childData = childSnapshot.val();
    var title = childData.titlevct;
    var paper = childData.papervct;
    $("#history").append("<article>"+"<h3 class='major papers'>"+title+"</h3>"+"</article>");
  });
});
 annyang.start();
  }
 });
});
//functions
var ref = new Firebase("https://vct.firebaseio.com/console");
ref.on("child_added", function(snapshot, prevChildKey) {
var newPost = snapshot.val();
var consolefn = (newPost.consolefn);
document.getElementById("functions").innerText = consolefn;});
//history
$('#history').click(function(e){
var txt = $(e.target).text();
document.getElementById("paper").innerText = txt;});
//menu
$("#finance").click( function(){ document.getElementById("paper").innerText = "what is the status?"; 
var msg = new SpeechSynthesisUtterance('The status is: '); 
window.speechSynthesis.speak(msg); 
});
$("#settings").click( function(){ document.getElementById("paper").innerHTML = "What can I do?"; var msg = new SpeechSynthesisUtterance('Fastur is the easiest way to build'); window.speechSynthesis.speak(msg);}       );
$("#people").click( function(){ document.getElementById("paper").innerText = "Who do you want to invite?"; var msg = new SpeechSynthesisUtterance('Who do you want to invite?'); window.speechSynthesis.speak(msg);});
mixpanel.track(window.location.host + " loaded", { });
//annyang
if (annyang) {
uid = localStorage.getItem("uid");
var commands = {
'*term': function(term) {
$("#paper").append(" " + term);
var url = "https://vct.firebaseio.com/" + uid; 
var firebaseRef = new Firebase(url); 
var postRef = firebaseRef.push(); 
postRef.set({papervct: term});
 }};
 annyang.addCommands(commands); }

/*get public papers*/
senddate = localStorage.getItem("date");
$(document).ready(function(){  
var ref = new Firebase("https://vct.firebaseio.com/public" );
ref.once("value", function(snapshot) {
  // The callback function will get called twice, once for "fred" and once for "barney"
   
  snapshot.forEach(function(childSnapshot) {
    // key will be "fred" the first time and "barney" the second time
    var key = childSnapshot.key();
    // childData will be the actual contents of the child
    var childData = childSnapshot.val();
    var title = childData.titlevct;
    var paperwt = childData.papervct;
    var paperwot = paperwt.replace(title, '');
    paperwot = paperwot.toLowerCase();
    var date = childData.senddate;
    $("#paper").append("<article class='post editable'>"+"<header>"+"<div class='title titleclicked'>"+"<h2>"+"<a>"+title+"</a>"+"</h2>"+"</div>"+"<div class='meta'>"+"<time><b>"+date+"</b></time>"+"<br><a class='icon fa-user'>&nbsp;1</a>"+"</div>"+"</header>"+"<p id='countpaper'>"+paperwot+"</p>"+"<footer>"+"</footer></article>");
    });
});
});

//get data and send to base
$.getJSON('https://api.import.io/store/data/0253ebd1-8e30-4fc8-85c8-c1705b2aa11a/_query?input/webpage/url=http%3A%2F%2Fstackshare.io%2Ftrending%2Ftools&_user=7b4c104f-aa5a-4a33-99f3-8ef4c663f949&_apikey=7b4c104faa5a4a3399f38ef4c663f949c76e045d901de9892ee614a97afdb223dde0bd3f47db54662dcae9679071c3feee11a602998ff66702f39fff3a977d8504683fdc36418074a929318a50b1df83', function(data){
console.log(data.results);
var validation_messages = data.results;
var key, obj, prop, owns = Object.prototype.hasOwnProperty;
for (key in validation_messages ) {
    if (owns.call(validation_messages, key)) {
        obj = validation_messages[key];
        for (prop in obj ) {
           if (owns.call(obj, prop)) {
                if (/bread/i.test(prop)){
                	//store in localstorage both vars then load them at end of loop
                	 $("#loading").css("display", "none");
            $("#paper").append("<article class='post editable'>"+"<header>"+"<div class='title titleclicked'>"+"<h2>"+"<a>"+obj[prop]+"</a>"+"</h2>"+"</div>");
                	senddate = localStorage.getItem("date");
                var term = obj[prop]; 
                var url = "https://vct.firebaseio.com/" + senddate; 
var firebaseRef = new Firebase(url); 
var postRef = firebaseRef.push(); 
postRef.set({papervct: term});}
                
                 else if(/description/i.test(prop)){
                    $("#paper").append("<div class='meta'>"+"<time><b>"+obj[prop]+"</b></time>"+"<br><a class='icon fa-user'>&nbsp;1</a>"+"</div>"+"</header>"+"<p id='countpaper'>"+obj[prop]+"</p>"+"<footer>"+"</footer></article>");

                        var term = obj[prop]; 
                var url = "https://vct.firebaseio.com/" + senddate; 
var firebaseRef = new Firebase(url); 
var postRef = firebaseRef.push(); 
postRef.set({papervct: term});}
                
                else{
                            console.log(prop, "=", obj[prop]);
               }
            }
        }
    }
}
});

</script>
<script>
var msg = new SpeechSynthesisUtterance('Hello World');
    window.speechSynthesis.speak(msg);
</script>
<script>
// identify site, go to base and get its html
// for fastur, resource for founders.
</script>
</body></html>
